<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} | Daily Fresh Juice</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    {% block head %}{% endblock %}
</head>

<body>
    <nav className="glass"
        style="position: fixed; top: 0; left: 0; right: 0; padding: 1rem 0; z-index: 50; background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
        <div class="container flex items-center justify-between">
            <a href="/" style="display: flex; align-items: center; gap: 0.5rem; text-decoration: none;">
                <i data-lucide="leaf" style="color: var(--primary);"></i>
                <span style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">
                    Daily<span style="color: var(--text-main);">Fresh</span>
                </span>
            </a>

            <div class="hidden-mobile" style="gap: 2rem;">
                {% if session.get('role') != 'rider' %}
                <a href="/menu" class="btn"
                    style="padding: 0.5rem; background: transparent; color: var(--text-main);">Menu</a>
                <a href="/subscribe" class="btn"
                    style="padding: 0.5rem; background: transparent; color: var(--text-main);">Plans</a>
                <a href="/track" class="btn"
                    style="padding: 0.5rem; background: transparent; color: var(--text-main);">Track Order</a>
                {% endif %}

                {% if session.get('user_id') %}
                <a href="{{ '/rider/dashboard' if session.get('role') == 'rider' else ('/admin' if session.get('role') == 'admin' else '/dashboard') }}"
                    class="btn" style="padding: 0.5rem; background: transparent; color: var(--text-main);">Dashboard</a>
                <a href="/logout" class="btn"
                    style="padding: 0.5rem; background: transparent; color: var(--text-main);">Log Out</a>
                {% else %}
                <a href="/login" class="btn"
                    style="padding: 0.5rem; background: transparent; color: var(--text-main);">Log In</a>
                {% endif %}
            </div>

            <div style="display: flex; gap: 1rem; align-items: center;">
                {% if session.get('role') != 'rider' %}
                <a href="/subscribe" class="btn btn-primary hidden-mobile">Order Now</a>
                {% endif %}
                <button class="btn hidden-desktop"
                    style="background: transparent; padding: 0.5rem; color: var(--text-main);" onclick="toggleMenu()">
                    <i data-lucide="menu"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="glass"
            style="display: none; position: absolute; top: 100%; left: 0; right: 0; padding: 2rem; border-top: 1px solid var(--border-color); flex-direction: column; gap: 1.5rem; background: white;">
            {% if session.get('role') != 'rider' %}
            <a href="/menu" class="btn" style="justify-content: flex-start; font-size: 1.2rem;">Menu</a>
            <a href="/subscribe" class="btn" style="justify-content: flex-start; font-size: 1.2rem;">Plans</a>
            <a href="/track" class="btn" style="justify-content: flex-start; font-size: 1.2rem;">Track Order</a>
            {% endif %}

            {% if session.get('user_id') %}
            <a href="{{ '/rider/dashboard' if session.get('role') == 'rider' else ('/admin' if session.get('role') == 'admin' else '/dashboard') }}"
                class="btn" style="justify-content: flex-start; font-size: 1.2rem;">My Dashboard</a>
            <a href="/logout" class="btn" style="justify-content: flex-start; font-size: 1.2rem; color: #ef4444;">Log
                Out</a>
            {% else %}
            <a href="/login" class="btn" style="justify-content: flex-start; font-size: 1.2rem;">Log In</a>
            {% endif %}

            {% if session.get('role') != 'rider' %}
            <hr style="border-color: var(--border-color);">
            <a href="/subscribe" class="btn btn-primary" style="width: 100%;">Order Now</a>
            {% endif %}
        </div>
    </nav>

    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer style="background: var(--text-main); color: white; padding: 4rem 1rem 6rem; margin-top: auto;">
        <div class="container"
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 3rem;">

            <!-- Brand -->
            <div>
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                    <i data-lucide="leaf" style="color: var(--primary);"></i>
                    <span style="font-size: 1.5rem; font-weight: 700; color: white;">
                        Daily<span style="color: var(--primary);">Fresh</span>
                    </span>
                </div>
                <p style="color: #94a3b8; font-size: 0.9rem; line-height: 1.6;">
                    Accra's #1 pressed-at-dawn juice delivery service. Fueling your ambition with raw nature.
                </p>
            </div>

            <!-- Quick Links -->
            <div>
                <h4 style="font-size: 1.1rem; margin-bottom: 1rem; color: white;">Quick Links</h4>
                <ul style="list-style: none; padding: 0; display: flex; flex-direction: column; gap: 0.75rem;">
                    {% if session.get('role') != 'rider' %}
                    <li><a href="/menu" style="color: #cbd5e1; text-decoration: none; transition: color 0.2s;">Our
                            Menu</a></li>
                    <li><a href="/subscribe"
                            style="color: #cbd5e1; text-decoration: none; transition: color 0.2s;">Plans & Pricing</a>
                    </li>
                    <li><a href="/track" style="color: #cbd5e1; text-decoration: none; transition: color 0.2s;">Track
                            Order</a></li>
                    {% endif %}
                    <li><a href="/faq" style="color: #cbd5e1; text-decoration: none; transition: color 0.2s;">FAQs</a>
                    </li>
                </ul>
            </div>

            <!-- Contact -->
            <div>
                <h4 style="font-size: 1.1rem; margin-bottom: 1rem; color: white;">Contact Us</h4>
                <ul style="list-style: none; padding: 0; display: flex; flex-direction: column; gap: 0.75rem;">
                    <li style="display: flex; gap: 0.75rem; color: #cbd5e1;">
                        <i data-lucide="map-pin" style="width: 18px;"></i>
                        East Legon, Accra
                    </li>
                    <li style="display: flex; gap: 0.75rem; color: #cbd5e1;">
                        <i data-lucide="phone" style="width: 18px;"></i>
                        +233 55 138 9510
                    </li>
                    <li style="display: flex; gap: 0.75rem; color: #cbd5e1;">
                        <i data-lucide="mail" style="width: 18px;"></i>
                        hello@dailyfresh.gh
                    </li>
                    <li style="margin-top: 1rem;">
                        <a href="/rider/signup"
                            style="color: var(--primary); font-weight: bold; text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                            <i data-lucide="bike" style="width: 18px;"></i> Become a Rider
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Newsletter -->
            <div>
                <h4 style="font-size: 1.1rem; margin-bottom: 1rem; color: white;">Stay Fresh</h4>
                <p style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 1rem;">Get health tips and exclusive
                    discounts.</p>
                <form onsubmit="event.preventDefault()" style="display: flex; gap: 0.5rem;">
                    <input type="email" placeholder="Your email"
                        style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; padding: 0.5rem; border-radius: 0.25rem; width: 100%;">
                    <button class="btn btn-primary" style="padding: 0.5rem 1rem;">Go</button>
                </form>
            </div>
        </div>
        <div class="container"
            style="border-top: 1px solid rgba(255,255,255,0.1); margin-top: 3rem; padding-top: 2rem; text-align: center; color: #64748b; font-size: 0.85rem;">
            &copy; 2026 Daily Fresh Juice. All rights reserved.
        </div>
    </footer>

    <!-- Chat Widget Toggle -->
    <button onclick="toggleChat()"
        style="position: fixed; bottom: 2rem; right: 2rem; background: var(--primary); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(22, 163, 74, 0.4); z-index: 100; border: none; cursor: pointer; transition: transform 0.2s;">
        <i data-lucide="message-circle" style="width: 32px; height: 32px;"></i>
    </button>

    <!-- Chat Widget Window -->
    <div id="chat-widget"
        style="display: none; position: fixed; bottom: 7rem; right: 2rem; width: 350px; height: 500px; background: white; border-radius: 1rem; box-shadow: 0 10px 25px rgba(0,0,0,0.1); z-index: 99; flex-direction: column; overflow: hidden; border: 1px solid var(--border-color);">

        <!-- Header -->
        <div
            style="background: var(--primary); padding: 1rem; color: white; display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 0.5rem;">
                <div style="width: 10px; height: 10px; background: #4ade80; border-radius: 50%;"></div>
                <span style="font-weight: bold;">DailyFresh Assistant</span>
            </div>
            <button onclick="toggleChat()" style="background: none; border: none; color: white; cursor: pointer;">
                <i data-lucide="x" style="width: 20px;"></i>
            </button>
        </div>

        <!-- Messages Area -->
        <div id="chat-messages"
            style="flex: 1; padding: 1rem; overflow-y: auto; display: flex; flex-direction: column; gap: 1rem; background: #f8fafc;">
            <!-- Welcome Message -->
            <div
                style="align-self: flex-start; background: white; padding: 0.75rem; border-radius: 0 1rem 1rem 1rem; border: 1px solid var(--border-color); max-width: 80%;">
                Hi there! ðŸ‘‹ I'm here to help. What would you like to know?
            </div>

            <!-- Options -->
            <div class="chat-options" style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                <button onclick="askQuestion('pricing')" class="btn"
                    style="font-size: 0.8rem; padding: 0.4rem 0.8rem; border: 1px solid var(--primary); color: var(--primary); background: #ecfdf5;">ðŸ’°
                    Pricing</button>
                <button onclick="askQuestion('delivery')" class="btn"
                    style="font-size: 0.8rem; padding: 0.4rem 0.8rem; border: 1px solid var(--primary); color: var(--primary); background: #ecfdf5;">ðŸšš
                    Delivery Areas</button>
                <button onclick="askQuestion('subscribe')" class="btn"
                    style="font-size: 0.8rem; padding: 0.4rem 0.8rem; border: 1px solid var(--primary); color: var(--primary); background: #ecfdf5;">ðŸ“…
                    How to Subscribe</button>
                <button onclick="askQuestion('human')" class="btn"
                    style="font-size: 0.8rem; padding: 0.4rem 0.8rem; border: 1px solid var(--primary); color: var(--primary); background: #ecfdf5;">ðŸ‘¤
                    Talk to Human</button>
            </div>
        </div>

        <!-- Input Area -->
        <div style="padding: 1rem; border-top: 1px solid var(--border-color); display: flex; gap: 0.5rem;">
            <input type="text" id="chat-input" placeholder="Type a message..." onkeypress="handleKeyPress(event)"
                style="flex: 1; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 0.5rem; background: white;">
            <button onclick="sendMessage()"
                style="background: none; border: none; color: var(--primary); cursor: pointer;"><i
                    data-lucide="send"></i></button>
        </div>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({
            duration: 800,
            once: true,
            offset: 100
        });
        lucide.createIcons();

        function toggleMenu() {
            const menu = document.getElementById('mobile-menu');
            if (menu.style.display === 'flex') {
                menu.style.display = 'none';
            } else {
                menu.style.display = 'flex';
            }
        }

        function toggleChat() {
            const widget = document.getElementById('chat-widget');
            if (widget.style.display === 'none' || widget.style.display === '') {
                widget.style.display = 'flex';
                // Focus input when opened
                setTimeout(() => document.getElementById('chat-input').focus(), 100);
            } else {
                widget.style.display = 'none';
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (message === "") return;

            // Display User Message
            appendMessage(message, 'user');
            input.value = "";

            // Bot Thinking
            showTyping();

            // Simple Keyword Logic
            setTimeout(() => {
                let response = "I'm not sure about that. Try one of the options above or click 'Talk to Human' for WhatsApp support.";
                const lowerMsg = message.toLowerCase();

                if (lowerMsg.includes('price') || lowerMsg.includes('cost') || lowerMsg.includes('how much')) {
                    response = "Our bottles start at GHâ‚µ 10.00 for the Daily Starter. The weekly Office Pack is GHâ‚µ 70.00.";
                } else if (lowerMsg.includes('deliver') || lowerMsg.includes('where') || lowerMsg.includes('location')) {
                    response = "We deliver 100% FREE between 6am and 10am to most areas in Accra.";
                } else if (lowerMsg.includes('hello') || lowerMsg.includes('hi')) {
                    response = "Hello! ðŸ‘‹ How can I keep you fresh today?";
                } else if (lowerMsg.includes('subscribe') || lowerMsg.includes('buy') || lowerMsg.includes('order')) {
                    response = "You can subscribe easily on our Subscribe page. Just select a plan and we handle the rest!";
                }

                removeTyping();
                appendMessage(response, 'bot');
            }, 1000);
        }

        function askQuestion(topic) {
            let userText = "";
            if (topic === 'pricing') userText = 'Tell me about pricing';
            else if (topic === 'delivery') userText = 'Where do you deliver?';
            else if (topic === 'subscribe') userText = 'How does it work?';
            else if (topic === 'human') userText = 'Talk to a human';

            appendMessage(userText, 'user');
            showTyping();

            setTimeout(() => {
                let response = "";
                if (topic === 'pricing') {
                    response = "Our bottles start at GHâ‚µ 10.00 for the Daily Starter. The weekly Office Pack (5 bottles) is GHâ‚µ 70.00.";
                } else if (topic === 'delivery') {
                    response = "We deliver to most areas in Accra! Delivery is 100% FREE between 6am and 10am.";
                } else if (topic === 'subscribe') {
                    response = "It's simple! Choose a plan on our Subscribe page, pay securely via Paystack, and we start delivering the next morning.";
                } else if (topic === 'human') {
                    response = "Redirecting you to our WhatsApp support... ðŸš€";
                    setTimeout(() => {
                        window.open("https://wa.me/233551389510", "_blank");
                    }, 1500);
                }
                removeTyping();
                appendMessage(response, 'bot');
            }, 1000);
        }

        function appendMessage(text, sender) {
            const messages = document.getElementById('chat-messages');
            const bubble = document.createElement('div');

            if (sender === 'user') {
                bubble.style.alignSelf = 'flex-end';
                bubble.style.background = 'var(--primary)';
                bubble.style.color = 'white';
                bubble.style.padding = '0.75rem';
                bubble.style.borderRadius = '1rem 1rem 0 1rem';
                bubble.style.maxWidth = '80%';
            } else {
                bubble.style.alignSelf = 'flex-start';
                bubble.style.background = 'white';
                bubble.style.padding = '0.75rem';
                bubble.style.borderRadius = '0 1rem 1rem 1rem';
                bubble.style.border = '1px solid var(--border-color)';
                bubble.style.maxWidth = '80%';
            }

            bubble.innerText = text;
            messages.appendChild(bubble);
            messages.scrollTo(0, messages.scrollHeight);
        }

        function showTyping() {
            const messages = document.getElementById('chat-messages');
            const typing = document.createElement('div');
            typing.id = 'typing-indicator';
            typing.style.alignSelf = 'flex-start';
            typing.style.color = 'var(--text-muted)';
            typing.style.fontSize = '0.8rem';
            typing.style.marginBottom = '1rem';
            typing.style.marginLeft = '1rem';
            typing.innerText = 'DailyFresh Assistant is typing...';
            messages.appendChild(typing);
            messages.scrollTo(0, messages.scrollHeight);
        }

        function removeTyping() {
            const messages = document.getElementById('chat-messages');
            const indicator = document.getElementById('typing-indicator');
            if (indicator) messages.removeChild(indicator);
        }
    </script>
    <script>
        // Base script content
    </script>
    {% block scripts %}{% endblock %}
</body>

</html>